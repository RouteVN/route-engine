file: "../../../src/stores/system.store.js"
group: systemStore.addToHistorySequence
suites: [addToHistorySequence]
---
suite: addToHistorySequence
exportName: addToHistorySequence
---
case: add item to history with empty history
in:
  - state:
      global:
        pendingEffects: []
      contexts:
        - historySequence: []
  - item:
      sectionId: "intro"
out:
  global:
    pendingEffects:
      - name: "render"
  contexts:
    - historySequence:
        - sectionId: "intro"
          lines: []
---
case: add item to history with existing items
in:
  - state:
      global:
        pendingEffects: []
      contexts:
        - historySequence:
            - sectionId: "intro"
              lines:
                - id: "1"
                - id: "2"
  - item:
      sectionId: "chapter1"
out:
  global:
    pendingEffects:
      - name: "render"
  contexts:
    - historySequence:
        - sectionId: "intro"
          lines:
            - id: "1"
            - id: "2"
        - sectionId: "chapter1"
          lines: []
---
case: add item to history with multiple contexts (should add to last one)
in:
  - state:
      global:
        pendingEffects: []
      contexts:
        - historySequence:
            - sectionId: "chapter1"
              lines:
                - id: "1"
        - historySequence:
            - sectionId: "menu"
              lines:
                - id: "1"
  - item:
      sectionId: "settings"
out:
  global:
    pendingEffects:
      - name: "render"
  contexts:
    - historySequence:
        - sectionId: "chapter1"
          lines:
            - id: "1"
    - historySequence:
        - sectionId: "menu"
          lines:
            - id: "1"
        - sectionId: "settings"
          lines: []
---
case: add item to history with existing pending effects
in:
  - state:
      global:
        pendingEffects:
          - name: "existingEffect"
            data: "test"
      contexts:
        - historySequence: []
  - item:
      sectionId: "intro"
out:
  global:
    pendingEffects:
      - name: "existingEffect"
        data: "test"
      - name: "render"
  contexts:
    - historySequence:
        - sectionId: "intro"
          lines: []
---
case: add section transition (only sectionId is stored, lines start empty)
in:
  - state:
      global:
        pendingEffects: []
      contexts:
        - historySequence:
            - sectionId: "intro"
              lines:
                - id: "1"
                  stateBefore:
                    score: 0
  - item:
      sectionId: "chapter2"
out:
  global:
    pendingEffects:
      - name: "render"
  contexts:
    - historySequence:
        - sectionId: "intro"
          lines:
            - id: "1"
              stateBefore:
                score: 0
        - sectionId: "chapter2"
          lines: []
