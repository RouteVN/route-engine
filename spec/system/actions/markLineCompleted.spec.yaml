file: "../../../src/stores/system.store.js"
group: systemStore.markLineCompleted
suites: [markLineCompleted]
---
suite: markLineCompleted
exportName: markLineCompleted
---
case: mark line as completed
in:
  - state:
      global:
        isLineCompleted: false
        pendingEffects: []
out:
  global:
    isLineCompleted: true
    pendingEffects:
      - name: render
---
case: mark line as completed when already completed (no-op)
in:
  - state:
      global:
        isLineCompleted: true
        pendingEffects: []
out:
  global:
    isLineCompleted: true
    pendingEffects: []
---
case: mark line as completed with existing pending effects
in:
  - state:
      global:
        isLineCompleted: false
        pendingEffects:
          - name: existingEffect
            data: test
out:
  global:
    isLineCompleted: true
    pendingEffects:
      - name: existingEffect
        data: test
      - name: render
---
case: mark line as completed with auto mode enabled starts auto timer
in:
  - state:
      global:
        isLineCompleted: false
        autoMode: true
        autoplayDelay: 1000
        nextLineConfig:
          manual:
            enabled: true
          auto:
            enabled: false
        pendingEffects: []
out:
  global:
    isLineCompleted: true
    autoMode: true
    autoplayDelay: 1000
    nextLineConfig:
      manual:
        enabled: true
      auto:
        enabled: false
    pendingEffects:
      - name: startAutoNextTimer
        payload:
          delay: 1000
      - name: render
---
case: mark line as completed with scene mode enabled (fromComplete) starts scene timer
in:
  - state:
      global:
        isLineCompleted: false
        autoMode: false
        nextLineConfig:
          manual:
            enabled: true
          auto:
            enabled: true
            trigger: "fromComplete"
            delay: 2000
        pendingEffects: []
out:
  global:
    isLineCompleted: true
    autoMode: false
    nextLineConfig:
      manual:
        enabled: true
      auto:
        enabled: true
        trigger: "fromComplete"
        delay: 2000
    pendingEffects:
      - name: nextLineConfigTimer
        payload:
          delay: 2000
      - name: render
---
case: mark line as completed with scene mode enabled (fromStart) does not start timer
in:
  - state:
      global:
        isLineCompleted: false
        autoMode: false
        nextLineConfig:
          manual:
            enabled: true
          auto:
            enabled: true
            trigger: "fromStart"
            delay: 1500
        pendingEffects: []
out:
  global:
    isLineCompleted: true
    autoMode: false
    nextLineConfig:
      manual:
        enabled: true
      auto:
        enabled: true
        trigger: "fromStart"
        delay: 1500
    pendingEffects:
      - name: render