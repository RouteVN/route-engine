file: "../../src/stores/system.store.js"
group: systemStore selectors
suites:
  [
    selectPendingEffects,
    selectSkipMode,
    selectAutoMode,
    selectIsLineViewed,
    selectIsResourceViewed,
    selectSaveSlots,
    selectSaveSlot,
  ]
---
# suite: createInitialState
# exportName: createInitialState
# ---
# case: initial state
# in: []
# out:
#   global:
#     pendingEffects: []
#     autoMode: false
#     skipMode: false
# ---
suite: selectPendingEffects
exportName: selectPendingEffects
---
case: empty pending effects
in:
  - state:
      global:
        pendingEffects: []
out: []
---
case: empty pending effects
in:
  - state:
      global:
        pendingEffects:
          - type: "asdf"
out:
  - type: "asdf"

---
suite: selectSkipMode
exportName: selectSkipMode
---
case: "false"
in:
  - state:
      global:
        skipMode: false
out: false
---
case: "true"
in:
  - state:
      global:
        skipMode: true
out: true
---
suite: selectAutoMode
exportName: selectAutoMode
---
case: "false"
in:
  - state:
      global:
        autoMode: false
out: false
---
case: "true"
in:
  - state:
      global:
        autoMode: true
out: true

---
suite: selectIsLineViewed
exportName: selectIsLineViewed
---
case: section not found
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
              lastLineId: "10"
  - sectionId: "xyz"
    lineId: "5"
out: false
---
case: section fully viewed (lastLineId undefined) with lineId
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
  - sectionId: "abc"
    lineId: "anyLineId"
out: true
---
case: section fully viewed (lastLineId undefined) without lineId
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
  - sectionId: "abc"
out: true
---
case: section exists with lastLineId, no lineId provided
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
              lastLineId: "10"
  - sectionId: "abc"
out: true
---
case: lineId equals lastLineId
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
              lastLineId: "10"
  - sectionId: "abc"
    lineId: "10"
out: false
---
case: lineId before lastLineId (numeric comparison)
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
              lastLineId: "10"
  - sectionId: "abc"
    lineId: "5"
out: false
---
case: lineId after lastLineId (numeric comparison)
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
              lastLineId: "10"
  - sectionId: "abc"
    lineId: "15"
out: false
---
case: multiple sections, check viewed section
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
              lastLineId: "10"
            - sectionId: "xyz"
            - sectionId: "def"
              lastLineId: "20"
  - sectionId: "xyz"
    lineId: "anyLineId"
out: true
---
case: multiple sections, check unviewed section
in:
  - state:
      global:
        viewedRegistry:
          sections:
            - sectionId: "abc"
              lastLineId: "10"
            - sectionId: "xyz"
              lastLineId: undefined
  - sectionId: "notfound"
    lineId: "5"
out: false

---
suite: selectIsResourceViewed
exportName: selectIsResourceViewed
---
case: resource not found
in:
  - state:
      global:
        viewedRegistry:
          resources:
            - resourceId: "existing_resource.jpg"
            - resourceId: "another_resource.png"
  - resourceId: "missing_resource.gif"
out: false
---
case: resource found
in:
  - state:
      global:
        viewedRegistry:
          resources:
            - resourceId: "image1.jpg"
            - resourceId: "sound1.mp3"
            - resourceId: "video1.mp4"
  - resourceId: "sound1.mp3"
out: true
---
case: empty resources registry
in:
  - state:
      global:
        viewedRegistry:
          resources: []
  - resourceId: "any_resource.png"
out: false
---
case: check first resource
in:
  - state:
      global:
        viewedRegistry:
          resources:
            - resourceId: "first_resource.jpg"
            - resourceId: "second_resource.png"
  - resourceId: "first_resource.jpg"
out: true
---
case: check last resource
in:
  - state:
      global:
        viewedRegistry:
          resources:
            - resourceId: "resource1.jpg"
            - resourceId: "resource2.png"
            - resourceId: "resource3.gif"
  - resourceId: "resource3.gif"
out: true
---
case: numeric resourceId found
in:
  - state:
      global:
        viewedRegistry:
          resources:
            - resourceId: 42
            - resourceId: "text_resource.jpg"
  - resourceId: 42
out: true
---
case: numeric resourceId not found
in:
  - state:
      global:
        viewedRegistry:
          resources:
            - resourceId: "text_resource.jpg"
            - resourceId: "image_resource.png"
  - resourceId: 42
out: false
---
case: resource with special characters found
in:
  - state:
      global:
        viewedRegistry:
          resources:
            - resourceId: "resource-with-dash.jpg"
            - resourceId: "resource_with_underscore.png"
            - resourceId: "resource.with.dots.gif"
  - resourceId: "resource.with.dots.gif"
out: true

---
suite: selectSaveSlots
exportName: selectSaveSlots
---
case: empty save slots
in:
  - state:
      global:
        saveSlots: {}
out: {}
---
case: save slots with multiple entries
in:
  - state:
      global:
        saveSlots:
          "1":
            date: "2024-01-01T12:00:00Z"
            image: "base64..."
            state:
              test: "value1"
          "2":
            date: "2024-01-02T15:30:00Z"
            image: "base64..."
            state:
              test: "value2"
          "autosave":
            date: "2024-01-03T09:15:00Z"
            image: "base64..."
            state:
              test: "autosave_value"
out:
  "1":
    date: "2024-01-01T12:00:00Z"
    image: "base64..."
    state:
      test: "value1"
  "2":
    date: "2024-01-02T15:30:00Z"
    image: "base64..."
    state:
      test: "value2"
  "autosave":
    date: "2024-01-03T09:15:00Z"
    image: "base64..."
    state:
      test: "autosave_value"
---
case: save slots with single entry
in:
  - state:
      global:
        saveSlots:
          "5":
            date: "2024-12-25T00:00:00Z"
            image: "holiday_save.png"
            state:
              progress: 75
out:
  "5":
    date: "2024-12-25T00:00:00Z"
    image: "holiday_save.png"
    state:
      progress: 75

---
suite: selectSaveSlot
exportName: selectSaveSlot
---
case: save slot not found
in:
  - state:
      global:
        saveSlots:
          "1":
            date: "2024-01-01T12:00:00Z"
            image: "base64..."
            state:
              test: "value"
  - slotKey: "999"
out: __undefined__
---
case: save slot found
in:
  - state:
      global:
        saveSlots:
          "1":
            date: "2024-01-01T12:00:00Z"
            image: "save1.png"
            state:
              level: 5
            score: 1000
          "2":
            date: "2024-01-02T15:30:00Z"
            image: "save2.png"
            state:
              level: 10
            score: 2500
  - slotKey: "2"
out:
  date: "2024-01-02T15:30:00Z"
  image: "save2.png"
  state:
    level: 10
  score: 2500
---
case: save slot found with numeric slotKey
in:
  - state:
      global:
        saveSlots:
          "3":
            date: "2024-03-15T20:45:00Z"
            image: "save3.png"
            state:
              completed: true
            playtime: 1200
  - slotKey: "3"
out:
  date: "2024-03-15T20:45:00Z"
  image: "save3.png"
  state:
    completed: true
  playtime: 1200
---
case: save slot found with string slotKey
in:
  - state:
      global:
        saveSlots:
          "autosave":
            date: "2024-01-01T12:00:00Z"
            image: "auto.png"
            state:
              auto: true
            lastAction: "dialogue"
          "quicksave":
            date: "2024-01-01T12:05:00Z"
            image: "quick.png"
            state:
              quick: true
            lastAction: "menu"
  - slotKey: "autosave"
out:
  date: "2024-01-01T12:00:00Z"
  image: "auto.png"
  state:
    auto: true
  lastAction: "dialogue"
---
case: empty save slots registry
in:
  - state:
      global:
        saveSlots: {}
  - slotKey: "1"
out: "__undefined__"
