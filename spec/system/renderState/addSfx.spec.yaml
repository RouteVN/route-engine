file: "../../../src/stores/constructRenderState.js"
group: constructRenderState.addSfx
suites: [addSfx]
---
suite: addSfx
exportName: addSfx
---
case: add sfx audio to story container
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items:
          - id: "sfx1"
            audioId: "soundEffect"
    resources:
      audio:
        soundEffect:
          fileId: "effect.mp3"
          loop: false
          volume: 0.7
          delay: 0
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio:
    - id: "sfx1"
      type: "sound"
      url: "effect.mp3"
      loop: false
      volume: 0.7
      delay: 0
---
case: add sfx with default values
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items:
          - id: "sfx1"
            audioId: "simpleSound"
    resources:
      audio:
        simpleSound:
          fileId: "simple.mp3"
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio:
    - id: "sfx1"
      type: "sound"
      url: "simple.mp3"
      loop: true
      volume: 0.5
      delay: null
---
case: add sfx with custom settings
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items:
          - id: "sfx1"
            audioId: "customSound"
            loop: true
            volume: 0.3
            delay: 500
    resources:
      audio:
        customSound:
          fileId: "custom.mp3"
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio:
    - id: "sfx1"
      type: "sound"
      url: "custom.mp3"
      loop: true
      volume: 0.3
      delay: 500
---
case: multiple sfx items
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items:
          - id: "sfx1"
            audioId: "firstSound"
          - id: "sfx2"
            audioId: "secondSound"
    resources:
      audio:
        firstSound:
          fileId: "first.mp3"
          volume: 0.6
        secondSound:
          fileId: "second.mp3"
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio:
    - id: "sfx1"
      type: "sound"
      url: "first.mp3"
      loop: true
      volume: 0.6
      delay: null
    - id: "sfx2"
      type: "sound"
      url: "second.mp3"
      loop: true
      volume: 0.5
      delay: null
---
case: no presentationState.sfx - return unchanged state
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState: {}
    resources:
      audio:
        soundEffect:
          fileId: "effect.mp3"
          loop: true
          volume: 0.7
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio: []
---
case: story container does not exist - return unchanged state
in:
  - elements:
      - id: "notStory"
        type: "container"
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items:
          - id: "sfx1"
            audioId: "soundEffect"
    resources:
      audio:
        soundEffect:
          fileId: "effect.mp3"
          loop: true
          volume: 0.7
out:
  elements:
    - id: "notStory"
      type: "container"
      children: []
  animations: []
  audio:
    - id: "sfx1"
      type: "sound"
      url: "effect.mp3"
      loop: true
      volume: 0.7
      delay: null
---
case: audio not found - skip item
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items:
          - id: "sfx1"
            audioId: "nonExistent"
    resources:
      audio:
        existing:
          fileId: "existing.mp3"
          loop: true
          volume: 0.7
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio: []
---
case: no sfx items - return unchanged state
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items: []
    resources:
      audio:
        soundEffect:
          fileId: "effect.mp3"
          loop: true
          volume: 0.7
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio: []
---
case: null resources - return unchanged state
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
    audio: []
  - presentationState:
      sfx:
        items:
          - id: "sfx1"
            audioId: "soundEffect"
    resources: null
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
  audio: []