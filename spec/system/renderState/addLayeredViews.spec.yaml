file: "../../../src/stores/constructRenderState.js"
group: constructRenderState.addLayeredViews
suites: [addLayeredViews]
---
suite: addLayeredViews
exportName: addLayeredViews
---
case: return unchanged state when layeredViews array is empty
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources: {}
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews: []
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
---
case: return unchanged state when layeredViews is undefined
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources: {}
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
---
case: add single layeredView layout to elements
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        layeredViewLayout:
          elements:
            - type: "text"
              content: "LayeredView content"
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: layeredViewLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - type: "text"
          content: "LayeredView content"
  animations: []
---
case: add multiple layeredViews with correct indices
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        menuLayout:
          elements:
            - type: "text"
              content: "Menu"
        overlayLayout:
          elements:
            - type: "image"
              src: "overlay.png"
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: menuLayout
        resourceType: layout
      - resourceId: overlayLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - type: "text"
          content: "Menu"
    - id: "layeredView-1"
      type: "container"
      x: 0
      y: 0
      children:
        - type: "image"
          src: "overlay.png"
  animations: []
---
case: skip layeredView when layout resource not found
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        existingLayout:
          elements:
            - type: "text"
              content: "Exists"
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: missingLayout
        resourceType: layout
      - resourceId: existingLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-1"
      type: "container"
      x: 0
      y: 0
      children:
        - type: "text"
          content: "Exists"
  animations: []
---
case: add transitions from layout to animations
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        animatedLayout:
          elements:
            - type: "text"
              content: "Animated"
          transitions:
            - type: "fadeIn"
              duration: 500
            - type: "slideUp"
              duration: 300
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: animatedLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - type: "text"
          content: "Animated"
  animations:
    - type: "fadeIn"
      duration: 500
    - type: "slideUp"
      duration: 300
---
case: handle layeredView with nested children
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        nestedLayout:
          elements:
            - type: "container"
              x: 10
              y: 20
              children:
                - type: "text"
                  content: "Nested text"
                - type: "image"
                  src: "icon.png"
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: nestedLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - type: "container"
          x: 10
          y: 20
          children:
            - type: "text"
              content: "Nested text"
            - type: "image"
              src: "icon.png"
  animations: []
---
case: handle layeredView with empty elements array
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        emptyLayout:
          elements: []
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: emptyLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children: []
  animations: []
---
case: resolve animations.in.resourceId to tween properties in layeredView elements
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        menuLayout:
          elements:
            - id: "menuButton"
              type: "rect"
              animations:
                in:
                  resourceId: "fadeIn"
      tweens:
        fadeIn:
          properties:
            alpha:
              from: 0
              to: 1
              duration: 500
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: menuLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - id: "menuButton"
          type: "rect"
          animations:
            in:
              properties:
                alpha:
                  from: 0
                  to: 1
                  duration: 500
  animations: []
---
case: resolve animations.out.resourceId to tween properties in layeredView elements
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        dialogLayout:
          elements:
            - id: "closeBtn"
              type: "rect"
              animations:
                out:
                  resourceId: "fadeOut"
      tweens:
        fadeOut:
          properties:
            alpha:
              from: 1
              to: 0
              duration: 300
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: dialogLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - id: "closeBtn"
          type: "rect"
          animations:
            out:
              properties:
                alpha:
                  from: 1
                  to: 0
                  duration: 300
  animations: []
---
case: resolve both in and out animations in layeredView
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        popupLayout:
          elements:
            - id: "popup"
              type: "container"
              animations:
                in:
                  resourceId: "scaleIn"
                out:
                  resourceId: "scaleOut"
      tweens:
        scaleIn:
          properties:
            scale:
              from: 0
              to: 1
              duration: 250
        scaleOut:
          properties:
            scale:
              from: 1
              to: 0
              duration: 250
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: popupLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - id: "popup"
          type: "container"
          animations:
            in:
              properties:
                scale:
                  from: 0
                  to: 1
                  duration: 250
            out:
              properties:
                scale:
                  from: 1
                  to: 0
                  duration: 250
  animations: []
---
case: resolve animations in nested children of layeredView recursively
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        settingsLayout:
          elements:
            - id: "settingsPanel"
              type: "container"
              children:
                - id: "volumeSlider"
                  type: "rect"
                  animations:
                    in:
                      resourceId: "slideIn"
      tweens:
        slideIn:
          properties:
            x:
              from: -200
              to: 0
              duration: 300
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: settingsLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - id: "settingsPanel"
          type: "container"
          children:
            - id: "volumeSlider"
              type: "rect"
              animations:
                in:
                  properties:
                    x:
                      from: -200
                      to: 0
                      duration: 300
  animations: []
---
case: layeredView animation resourceId not found keeps resourceId unchanged
in:
  - elements:
      - id: "story"
        type: "container"
        x: 0
        y: 0
        children: []
    animations: []
  - resources:
      layouts:
        brokenLayout:
          elements:
            - id: "element1"
              type: "rect"
              animations:
                in:
                  resourceId: "missingTween"
      tweens: {}
    variables: {}
    autoMode: false
    skipMode: false
    currentLocalizationPackageId: null
    layeredViews:
      - resourceId: brokenLayout
        resourceType: layout
out:
  elements:
    - id: "story"
      type: "container"
      x: 0
      y: 0
      children: []
    - id: "layeredView-0"
      type: "container"
      x: 0
      y: 0
      children:
        - id: "element1"
          type: "rect"
          animations:
            in:
              resourceId: "missingTween"
  animations: []
